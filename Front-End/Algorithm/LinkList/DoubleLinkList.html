<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    

    <script>

        function DoubleLinkList(){
            this.head = null;
            this.tail = null;
            this.length = 0;

            function Node(data){
                this.data = data;
                this.prev = null;
                this.next = null;
            }

            // append(element)
            DoubleLinkList.prototype.append = function(element){
                var newNode = new Node(element);

                if(this.length == 0){
                    this.head = newNode;
                    this.tail = newNode;
                }else{
                    newNode.prev = this.tail;
                    this.tail.next = newNode;

                    this.tail = newNode;
                }

                return ++ this.length;
            }
            // insert(position,element)
            DoubleLinkList.prototype.insert = function(position,element){
                // 判断position是否越界
                if(position < 0 || position > this.length)
                    return false;

                var newNode = new Node(element);
                // this.length === 0，双向链表多了个tail指针
                if(this.length === 0){
                    this.head = newNode;
                    this.tail = newNode;
                }else{
                    // this.length > 0
                    if(position == 0){
                        newNode.next = this.head;
                        this.head.prev = newNode;

                        this.head = newNode;
                    }else if(position == this.length){
                        this.tail.next = newNode;
                        newNode.prev = this.tail;

                        this.tail = newNode;
                    }else{
                        var node = this.head;
                        while(position){
                            node = node.next;
                            position --;
                        }
                        
                        newNode.next = node;
                        newNode.prev = node.prev;
                        node.prev.next = newNode;
                        node.prev = newNode;
                    }
                }

                this.length ++;
                return true;
            }

            // get(position)
            DoubleLinkList.prototype.get = function(position){
                // 判断position是否越界
                if(position < 0 || position > this.length - 1)
                    return  null;

                var temp = Math.ceil(this.length / 2);
                var node = temp > position 
                                ? this.head : this.tail;

                var index_p = temp > position
                                   ? position : this.length - 1 - position;
                while(index_p){
                    node = temp > position
                                ? node.next : node.prev;
                    index_p --;
                }

                return node;
            }
            // indexOf(element)：返回元素在链表的下标,失败返回-1
            DoubleLinkList.prototype.indexOf = function(element){
                var node = this.head;
                var index = 0;
                while(node){
                    if(node.data === element){
                        return index;
                    }
                    node = node.next;
                    index ++;
                }
                return -1;
            }

            // update(position,element)
            DoubleLinkList.prototype.update = function(position,element){
                // position是否越界,链表是否为NULL
                if(position < 0 || position > this.length - 1 || !this.length)
                    return false;
                
                var node = this.head;
                while(position){
                    node = node.next;
                    position --;
                }
                node.data = element;
                return true;
            }

            // removeAt(position)
            DoubleLinkList.prototype.removeAt = function(position){
                // 判断position是否越界,链表是否NULL
                if(position < 0 || position > this.length - 1 || !this.length)
                    return false;
                
                // 1、链表只有一个节点
                var node = this.head;
                if(this.length === 1){
                    this.head = null;
                    this.tail = null;
                }else{
                    // 结点数 > 1
                    if(position == 0){
                        this.head.next.prev = null;
                        this.head = this.head.next;

                    }else if(position == this.length - 1){
                        this.tail.prev.next = null;
                        node = this.tail;

                        this.tail = this.tail.prev;

                    }else {
                        while(position){
                            node = node.next;
                            position --;
                        }

                        node.prev.next = node.next;
                        node.next.prev = node.prev;
                    }                 
                    
                    node.prev = null;
                    node.next = null;
                }
                                        
                this.length --;
                return node;
            }
            // remove(element)
            DoubleLinkList.prototype.remove = function(element){
                var index = this.indexOf(element);
                return  this.removeAt(index);
            }

            // isEmpty()
            DoubleLinkList.prototype.isEmpty = function(){
                return this.length === 0;
            }
            // size()
            DoubleLinkList.prototype.size = function(){
                return this.length;
            }
            // toString()
            DoubleLinkList.prototype.toString = function(){
                var resultString = '';
                var node = this.head;
                while(node){
                    resultString += node.data;
                    node = node.next;
                }
                return resultString;
            }
            
            // fowarString():返回正向遍历的节点元素的字符串
            DoubleLinkList.prototype.forwardString = function(){
                var resultString = '';
                var node = this.head;
                while(node){
                    resultString += node.data;
                    node = node.next;
                }
                return resultString;
            }

            // backwordString():返回反向遍历的节点元素的字符串
            DoubleLinkList.prototype.backwordString = function(){
                var resultString = '';
                var node = this.tail;
                while(node){
                    resultString += node.data;
                    node = node.prev;
                }
                return resultString;
            }
        }

        // 测试代码
        var doubleList = new DoubleLinkList();
        doubleList.append("0");
        doubleList.append("1");
        doubleList.insert(0,"2");
        doubleList.insert(4,"3");
        doubleList.insert(2,"4");
            
    </script>

</body>
</html>